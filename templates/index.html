<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Todo App</title>
    <link href="//netdna.bootstrapcdn.com/bootstrap/3.1.0/css/bootstrap.min.css" rel="stylesheet" id="bootstrap-css">
    <script src="//netdna.bootstrapcdn.com/bootstrap/3.1.0/js/bootstrap.min.js"></script>
    <script src="//code.jquery.com/jquery-1.11.1.min.js"></script>
    <style>
        .bg-grey {
            background-color: #f2f2f2;
        }

        .flashes {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }

        .flash {
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 5px;
        }

        .flash.success {
            background-color: #dff0d8;
            color: #3c763d;
        }

        .flash.error {
            background-color: #f2dede;
            color: #a94442;
        }
        body {
          font-family: Arial, sans-serif;
          background-color: lightblue;
          margin: 0;
          padding: 0;
          display: flex;
          flex-direction: column;
          align-items: center;
          justify-content: center;
          height: 100vh;
        }

        .header {
          font-size: 24px;
          font-weight: bold;
          margin-bottom: 20px;
        }

        .container {
          display: flex;
          flex-wrap: wrap;
          justify-content: center;
          gap: 20px;
        }

        .text-bubble {
          flex: 1;
          padding: 15px;
          background-color: #e0e0e0;
          border-radius: 10px;
        }

        .text-bubble::after {
          content: '';
          position: absolute;
          top: 50%;
          right: 100%;
          border-width: 10px;
          border-style: solid;
          border-color: transparent #e0e0e0 transparent transparent;
          margin-top: -10px;
        }

        .todo-table {
          width: 100%;
        }

        .task-form {
          max-width: 300px;
        }

        .sort-container {
          display: flex;
          align-items: center;
        }

        .sort-dropdown {
          flex: 1;
        }

        .sort-button {
          margin-left: 10px;
        }

        .hide-row.fade-out {
          opacity: 0;
          transition: opacity 0.5s ease;
        }
        .fade-out.d-none {
          display: none;
        }

  </style>
</head>
<body>
    <div class="header">To-Do List</div>
        <!-- Display flash messages if any -->
            {% with messages = get_flashed_messages() %}
                {% if messages %}
                    <ul class="flashes">
                        {% for message in messages %}
                            <li class="flash">{{ message }}</li>
                        {% endfor %}
                    </ul>
                {% endif %}
            {% endwith %}
<!--End flash-->



<!--TO-DO list table-->

  <div class="container">
    <div class="text-bubble" style="height: auto">
      <table class="table">
            <thead>
                <tr>
                    <th>Description</th>
                    <th>Due Date</th>
                    <th>Category</th>
                    <th>Priority</th>
                    <th>Submitted</th>
                    <th>Completed</th>
                </tr>
            </thead>
                <tbody>
                    {% for todo_item in todo_items %}
                    <tr {% if loop.index is divisibleby(2) %}class="bg-grey"{% endif %}>
                    <td>{{ todo_item.description }}</td>
                    <td>{{ todo_item.due_date }}</td>
                    <td>{{ todo_item.category }}</td>
                    <td>{{ todo_item.priority }}</td>
                    <td>{{ todo_item.timestamp }}</td>
                    <td><input type="checkbox" name="todo_checkbox" class="item-checkbox" value="{{ todo_item.id }}"></td>
                    </tr>
                    {% endfor %}
                </tbody>
     </table>
    </div>


            <!-- Task Submission Form fields -->
            <div class="text-bubble task-form" style="height:500px">
              <form method="POST" action="{{ url_for('home') }}">
            <!-- Include CSRF token -->
            <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
              <!--token end-->

            <div class="text-bubble task-form">
                <label for="description" class="form-label">Description</label>
                <input type="text" class="form-control" id="description" name="description" maxlength="25">
            </div>
            <div class="text-bubble task-form">
                <label for="due_date" class="form-label">Due Date</label>
                <input type="date" class="form-control" id="due_date" name="due_date">
            </div>
            <div class="text-bubble task-form">
                <label for="category" class="form-label">Category</label>
                <select class="form-select" id="category" name="category">
                    <option value="work">Work</option>
                    <option value="personal">Personal</option>
                    <option value="other">Other</option>
                </select>
            </div>
            <div class="text-bubble task-form">
                <label for="priority" class="form-label">Priority</label>
                <select class="form-select" id="priority" name="priority">
                    <option value="low">Low</option>
                    <option value="normal">Normal</option>
                    <option value="urgent">Urgent</option>
                </select>
            </div>
            <button type="submit" class="btn btn-primary">Add Task</button>
            </form>
            </div>
          </div>
        </div>

    <!--sort by dropdown-->
<div class="container-flex">
    <form method="POST" action="{{ url_for('home') }}">
        <!-- Include CSRF token -->
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">

        <!-- Sorting options -->
        <div class="row align-items-left">
            <div class="col-md-2">
                <div class="sort-label">
                    <label for="sort_by" class="form-label">Sort By</label>
                </div>
            </div>


            <div class="col-md-3">
                <div class="sort-dropdown">
                    <select class="form-select" id="sort_by" name="sort_by" style="width: 115%;">
                        <option value="due_date">Date Due</option>
                        <option value="description">Alphabetical</option>
                        <option value="timestamp">Timestamp</option>
                        <option value="category">Category</option>
                        <option value="priority">Priority</option>
                    </select>
                </div>
            </div>
            <div class="col-md-3">
                <div class="sort-label">
                    <label for="sort_order">Sort Order</label>
                </div>
            </div>
            <div class="col-md-3">
                <div class="sort-dropdown">
                    <select class="form-select" name="sort_order" style="width:125%;">
                        <option value="asc" {% if sort_order == 'asc' %}selected{% endif %}>Ascending</option>
                        <option value="desc" {% if sort_order == 'desc' %}selected{% endif %}>Descending</option>
                    </select>
                </div>
            </div>
            <div class="col-md-1">
                <div class="sort-button">
                    <button type="submit" class="btn btn-primary">Sort</button>
                </div>
            </div>
        </div>
    </form>
</div>



<!--end sort by dropdown-->

    <!-- Add checkbox to unhide rows -->
<!--<div>-->
<!--  <input type="checkbox" id="unhide-checkbox">-->
<!--  <label for="unhide-checkbox">Show Completed Tasks</label>-->
<!--</div>-->




    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>